{"id":"socket.js","dependencies":[{"name":"D:\\personal\\Node-build-blockchain\\package.json","includedInParent":true,"mtime":1620869816151},{"name":"node-pty","loc":{"line":1,"column":20},"parent":"D:\\personal\\Node-build-blockchain\\socket.js","resolved":"D:\\personal\\Node-build-blockchain\\node_modules\\node-pty\\lib\\index.js"},{"name":"os","loc":{"line":2,"column":19},"parent":"D:\\personal\\Node-build-blockchain\\socket.js","resolved":"D:\\personal\\Node-build-blockchain\\node_modules\\os-browserify\\browser.js"},{"name":"ws","loc":{"line":3,"column":26},"parent":"D:\\personal\\Node-build-blockchain\\socket.js","resolved":"D:\\personal\\Node-build-blockchain\\node_modules\\ws\\index.js"},{"name":"./vorpal","loc":{"line":5,"column":23},"parent":"D:\\personal\\Node-build-blockchain\\socket.js","resolved":"D:\\personal\\Node-build-blockchain\\vorpal.js"},{"name":"process","parent":"D:\\personal\\Node-build-blockchain\\socket.js","resolved":"D:\\personal\\Node-build-blockchain\\node_modules\\process\\browser.js"}],"generated":{"js":"var process = require(\"process\");\nvar pty = require('node-pty');\n\nvar os = require('os');\n\nvar WebSocket = require('ws');\n\nvar shell = os.platform() === 'win32' ? 'powershell.exe' : 'bash';\n\nvar Vorpal = require('./vorpal');\n\nvar wss = new WebSocket.Server({\n  port: 4001\n});\nwss.on('connection', function (ws) {\n  console.log('socket connection success');\n  var ptyProcess = pty.spawn(shell, [], {\n    name: 'xterm-color',\n    cols: 80,\n    rows: 30,\n    cwd: \"C:\\\\Users\\\\montana\",\n    env: process.env\n  });\n  new Vorpal(); //接受数据\n\n  ws.on('message', function (res) {\n    console.log('接受数据', res);\n    ptyProcess.write(res);\n  }); //发送数据\n\n  ptyProcess.on('data', function (data) {\n    process.stdout.write(data);\n    console.log('发送数据', data);\n    ws.send(data);\n  });\n});"},"sourceMaps":{"js":{"mappings":[{"generated":{"line":2,"column":0},"source":"socket.js","original":{"line":1,"column":0}},{"name":"pty","generated":{"line":2,"column":4},"source":"socket.js","original":{"line":1,"column":6}},{"generated":{"line":2,"column":7},"source":"socket.js","original":{"line":1,"column":9}},{"name":"require","generated":{"line":2,"column":10},"source":"socket.js","original":{"line":1,"column":12}},{"generated":{"line":2,"column":17},"source":"socket.js","original":{"line":1,"column":19}},{"generated":{"line":2,"column":18},"source":"socket.js","original":{"line":1,"column":20}},{"generated":{"line":2,"column":28},"source":"socket.js","original":{"line":1,"column":19}},{"generated":{"line":2,"column":29},"source":"socket.js","original":{"line":1,"column":0}},{"generated":{"line":4,"column":0},"source":"socket.js","original":{"line":2,"column":0}},{"name":"os","generated":{"line":4,"column":4},"source":"socket.js","original":{"line":2,"column":6}},{"generated":{"line":4,"column":6},"source":"socket.js","original":{"line":2,"column":8}},{"name":"require","generated":{"line":4,"column":9},"source":"socket.js","original":{"line":2,"column":11}},{"generated":{"line":4,"column":16},"source":"socket.js","original":{"line":2,"column":18}},{"generated":{"line":4,"column":17},"source":"socket.js","original":{"line":2,"column":19}},{"generated":{"line":4,"column":21},"source":"socket.js","original":{"line":2,"column":18}},{"generated":{"line":4,"column":22},"source":"socket.js","original":{"line":2,"column":0}},{"generated":{"line":6,"column":0},"source":"socket.js","original":{"line":3,"column":0}},{"name":"WebSocket","generated":{"line":6,"column":4},"source":"socket.js","original":{"line":3,"column":6}},{"generated":{"line":6,"column":13},"source":"socket.js","original":{"line":3,"column":15}},{"name":"require","generated":{"line":6,"column":16},"source":"socket.js","original":{"line":3,"column":18}},{"generated":{"line":6,"column":23},"source":"socket.js","original":{"line":3,"column":25}},{"generated":{"line":6,"column":24},"source":"socket.js","original":{"line":3,"column":26}},{"generated":{"line":6,"column":28},"source":"socket.js","original":{"line":3,"column":25}},{"generated":{"line":6,"column":29},"source":"socket.js","original":{"line":3,"column":0}},{"generated":{"line":8,"column":0},"source":"socket.js","original":{"line":4,"column":0}},{"name":"shell","generated":{"line":8,"column":4},"source":"socket.js","original":{"line":4,"column":6}},{"generated":{"line":8,"column":9},"source":"socket.js","original":{"line":4,"column":11}},{"name":"os","generated":{"line":8,"column":12},"source":"socket.js","original":{"line":4,"column":14}},{"generated":{"line":8,"column":14},"source":"socket.js","original":{"line":4,"column":16}},{"name":"platform","generated":{"line":8,"column":15},"source":"socket.js","original":{"line":4,"column":17}},{"generated":{"line":8,"column":23},"source":"socket.js","original":{"line":4,"column":14}},{"generated":{"line":8,"column":30},"source":"socket.js","original":{"line":4,"column":32}},{"generated":{"line":8,"column":37},"source":"socket.js","original":{"line":4,"column":14}},{"generated":{"line":8,"column":40},"source":"socket.js","original":{"line":4,"column":42}},{"generated":{"line":8,"column":56},"source":"socket.js","original":{"line":4,"column":14}},{"generated":{"line":8,"column":59},"source":"socket.js","original":{"line":4,"column":61}},{"generated":{"line":8,"column":65},"source":"socket.js","original":{"line":4,"column":0}},{"generated":{"line":10,"column":0},"source":"socket.js","original":{"line":5,"column":0}},{"name":"Vorpal","generated":{"line":10,"column":4},"source":"socket.js","original":{"line":5,"column":6}},{"generated":{"line":10,"column":10},"source":"socket.js","original":{"line":5,"column":12}},{"name":"require","generated":{"line":10,"column":13},"source":"socket.js","original":{"line":5,"column":15}},{"generated":{"line":10,"column":20},"source":"socket.js","original":{"line":5,"column":22}},{"generated":{"line":10,"column":21},"source":"socket.js","original":{"line":5,"column":23}},{"generated":{"line":10,"column":31},"source":"socket.js","original":{"line":5,"column":22}},{"generated":{"line":10,"column":32},"source":"socket.js","original":{"line":5,"column":0}},{"generated":{"line":12,"column":0},"source":"socket.js","original":{"line":7,"column":0}},{"name":"wss","generated":{"line":12,"column":4},"source":"socket.js","original":{"line":7,"column":6}},{"generated":{"line":12,"column":7},"source":"socket.js","original":{"line":7,"column":9}},{"generated":{"line":12,"column":10},"source":"socket.js","original":{"line":7,"column":12}},{"name":"WebSocket","generated":{"line":12,"column":14},"source":"socket.js","original":{"line":7,"column":16}},{"generated":{"line":12,"column":23},"source":"socket.js","original":{"line":7,"column":25}},{"name":"Server","generated":{"line":12,"column":24},"source":"socket.js","original":{"line":7,"column":26}},{"generated":{"line":12,"column":30},"source":"socket.js","original":{"line":7,"column":12}},{"generated":{"line":12,"column":31},"source":"socket.js","original":{"line":7,"column":33}},{"name":"port","generated":{"line":13,"column":0},"source":"socket.js","original":{"line":7,"column":34}},{"name":"port","generated":{"line":13,"column":2},"source":"socket.js","original":{"line":7,"column":34}},{"generated":{"line":13,"column":6},"source":"socket.js","original":{"line":7,"column":38}},{"generated":{"line":13,"column":8},"source":"socket.js","original":{"line":7,"column":40}},{"generated":{"line":14,"column":0},"source":"socket.js","original":{"line":7,"column":33}},{"generated":{"line":14,"column":1},"source":"socket.js","original":{"line":7,"column":12}},{"generated":{"line":14,"column":2},"source":"socket.js","original":{"line":7,"column":0}},{"name":"wss","generated":{"line":15,"column":0},"source":"socket.js","original":{"line":9,"column":0}},{"generated":{"line":15,"column":3},"source":"socket.js","original":{"line":9,"column":3}},{"name":"on","generated":{"line":15,"column":4},"source":"socket.js","original":{"line":9,"column":4}},{"generated":{"line":15,"column":6},"source":"socket.js","original":{"line":9,"column":0}},{"generated":{"line":15,"column":7},"source":"socket.js","original":{"line":9,"column":7}},{"generated":{"line":15,"column":19},"source":"socket.js","original":{"line":9,"column":0}},{"generated":{"line":15,"column":21},"source":"socket.js","original":{"line":9,"column":21}},{"name":"ws","generated":{"line":15,"column":31},"source":"socket.js","original":{"line":9,"column":22}},{"generated":{"line":15,"column":33},"source":"socket.js","original":{"line":9,"column":21}},{"generated":{"line":15,"column":35},"source":"socket.js","original":{"line":9,"column":29}},{"name":"console","generated":{"line":16,"column":0},"source":"socket.js","original":{"line":10,"column":2}},{"name":"console","generated":{"line":16,"column":2},"source":"socket.js","original":{"line":10,"column":2}},{"generated":{"line":16,"column":9},"source":"socket.js","original":{"line":10,"column":9}},{"name":"log","generated":{"line":16,"column":10},"source":"socket.js","original":{"line":10,"column":10}},{"generated":{"line":16,"column":13},"source":"socket.js","original":{"line":10,"column":2}},{"generated":{"line":16,"column":14},"source":"socket.js","original":{"line":10,"column":14}},{"generated":{"line":16,"column":41},"source":"socket.js","original":{"line":10,"column":2}},{"generated":{"line":17,"column":0},"source":"socket.js","original":{"line":11,"column":2}},{"name":"ptyProcess","generated":{"line":17,"column":6},"source":"socket.js","original":{"line":11,"column":8}},{"generated":{"line":17,"column":16},"source":"socket.js","original":{"line":11,"column":18}},{"name":"pty","generated":{"line":17,"column":19},"source":"socket.js","original":{"line":11,"column":21}},{"generated":{"line":17,"column":22},"source":"socket.js","original":{"line":11,"column":24}},{"name":"spawn","generated":{"line":17,"column":23},"source":"socket.js","original":{"line":11,"column":25}},{"generated":{"line":17,"column":28},"source":"socket.js","original":{"line":11,"column":21}},{"name":"shell","generated":{"line":17,"column":29},"source":"socket.js","original":{"line":11,"column":31}},{"generated":{"line":17,"column":34},"source":"socket.js","original":{"line":11,"column":21}},{"generated":{"line":17,"column":36},"source":"socket.js","original":{"line":11,"column":38}},{"generated":{"line":17,"column":38},"source":"socket.js","original":{"line":11,"column":21}},{"generated":{"line":17,"column":40},"source":"socket.js","original":{"line":11,"column":42}},{"name":"name","generated":{"line":18,"column":0},"source":"socket.js","original":{"line":12,"column":4}},{"name":"name","generated":{"line":18,"column":4},"source":"socket.js","original":{"line":12,"column":4}},{"generated":{"line":18,"column":8},"source":"socket.js","original":{"line":12,"column":8}},{"generated":{"line":18,"column":10},"source":"socket.js","original":{"line":12,"column":10}},{"generated":{"line":18,"column":23},"source":"socket.js","original":{"line":11,"column":42}},{"name":"cols","generated":{"line":19,"column":0},"source":"socket.js","original":{"line":13,"column":4}},{"name":"cols","generated":{"line":19,"column":4},"source":"socket.js","original":{"line":13,"column":4}},{"generated":{"line":19,"column":8},"source":"socket.js","original":{"line":13,"column":8}},{"generated":{"line":19,"column":10},"source":"socket.js","original":{"line":13,"column":10}},{"generated":{"line":19,"column":12},"source":"socket.js","original":{"line":11,"column":42}},{"name":"rows","generated":{"line":20,"column":0},"source":"socket.js","original":{"line":14,"column":4}},{"name":"rows","generated":{"line":20,"column":4},"source":"socket.js","original":{"line":14,"column":4}},{"generated":{"line":20,"column":8},"source":"socket.js","original":{"line":14,"column":8}},{"generated":{"line":20,"column":10},"source":"socket.js","original":{"line":14,"column":10}},{"generated":{"line":20,"column":12},"source":"socket.js","original":{"line":11,"column":42}},{"name":"cwd","generated":{"line":21,"column":0},"source":"socket.js","original":{"line":15,"column":4}},{"name":"cwd","generated":{"line":21,"column":4},"source":"socket.js","original":{"line":15,"column":4}},{"generated":{"line":21,"column":7},"source":"socket.js","original":{"line":15,"column":7}},{"generated":{"line":21,"column":29},"source":"socket.js","original":{"line":11,"column":42}},{"name":"env","generated":{"line":22,"column":0},"source":"socket.js","original":{"line":16,"column":4}},{"name":"env","generated":{"line":22,"column":4},"source":"socket.js","original":{"line":16,"column":4}},{"generated":{"line":22,"column":7},"source":"socket.js","original":{"line":16,"column":7}},{"name":"process","generated":{"line":22,"column":9},"source":"socket.js","original":{"line":16,"column":9}},{"generated":{"line":22,"column":16},"source":"socket.js","original":{"line":16,"column":16}},{"name":"env","generated":{"line":22,"column":17},"source":"socket.js","original":{"line":16,"column":17}},{"generated":{"line":23,"column":0},"source":"socket.js","original":{"line":11,"column":42}},{"generated":{"line":23,"column":3},"source":"socket.js","original":{"line":11,"column":21}},{"generated":{"line":23,"column":4},"source":"socket.js","original":{"line":11,"column":2}},{"generated":{"line":24,"column":0},"source":"socket.js","original":{"line":18,"column":2}},{"name":"Vorpal","generated":{"line":24,"column":6},"source":"socket.js","original":{"line":18,"column":6}},{"generated":{"line":24,"column":12},"source":"socket.js","original":{"line":18,"column":2}},{"generated":{"line":24,"column":15},"source":"socket.js","original":{"line":9,"column":29}},{"generated":{"line":24,"column":16},"source":"socket.js","original":{"line":19,"column":2}},{"name":"ws","generated":{"line":26,"column":0},"source":"socket.js","original":{"line":20,"column":2}},{"name":"ws","generated":{"line":26,"column":2},"source":"socket.js","original":{"line":20,"column":2}},{"generated":{"line":26,"column":4},"source":"socket.js","original":{"line":20,"column":4}},{"name":"on","generated":{"line":26,"column":5},"source":"socket.js","original":{"line":20,"column":5}},{"generated":{"line":26,"column":7},"source":"socket.js","original":{"line":20,"column":2}},{"generated":{"line":26,"column":8},"source":"socket.js","original":{"line":20,"column":8}},{"generated":{"line":26,"column":17},"source":"socket.js","original":{"line":20,"column":2}},{"generated":{"line":26,"column":19},"source":"socket.js","original":{"line":20,"column":19}},{"name":"res","generated":{"line":26,"column":29},"source":"socket.js","original":{"line":20,"column":20}},{"generated":{"line":26,"column":32},"source":"socket.js","original":{"line":20,"column":19}},{"generated":{"line":26,"column":34},"source":"socket.js","original":{"line":20,"column":28}},{"name":"console","generated":{"line":27,"column":0},"source":"socket.js","original":{"line":21,"column":6}},{"name":"console","generated":{"line":27,"column":4},"source":"socket.js","original":{"line":21,"column":6}},{"generated":{"line":27,"column":11},"source":"socket.js","original":{"line":21,"column":13}},{"name":"log","generated":{"line":27,"column":12},"source":"socket.js","original":{"line":21,"column":14}},{"generated":{"line":27,"column":15},"source":"socket.js","original":{"line":21,"column":6}},{"generated":{"line":27,"column":16},"source":"socket.js","original":{"line":21,"column":18}},{"generated":{"line":27,"column":22},"source":"socket.js","original":{"line":21,"column":6}},{"name":"res","generated":{"line":27,"column":24},"source":"socket.js","original":{"line":21,"column":25}},{"generated":{"line":27,"column":27},"source":"socket.js","original":{"line":21,"column":6}},{"name":"ptyProcess","generated":{"line":28,"column":0},"source":"socket.js","original":{"line":22,"column":4}},{"name":"ptyProcess","generated":{"line":28,"column":4},"source":"socket.js","original":{"line":22,"column":4}},{"generated":{"line":28,"column":14},"source":"socket.js","original":{"line":22,"column":14}},{"name":"write","generated":{"line":28,"column":15},"source":"socket.js","original":{"line":22,"column":15}},{"generated":{"line":28,"column":20},"source":"socket.js","original":{"line":22,"column":4}},{"name":"res","generated":{"line":28,"column":21},"source":"socket.js","original":{"line":22,"column":21}},{"generated":{"line":28,"column":24},"source":"socket.js","original":{"line":22,"column":4}},{"generated":{"line":29,"column":0},"source":"socket.js","original":{"line":23,"column":3}},{"generated":{"line":29,"column":3},"source":"socket.js","original":{"line":20,"column":2}},{"generated":{"line":29,"column":5},"source":"socket.js","original":{"line":9,"column":29}},{"generated":{"line":29,"column":6},"source":"socket.js","original":{"line":24,"column":2}},{"name":"ptyProcess","generated":{"line":31,"column":0},"source":"socket.js","original":{"line":25,"column":2}},{"name":"ptyProcess","generated":{"line":31,"column":2},"source":"socket.js","original":{"line":25,"column":2}},{"generated":{"line":31,"column":12},"source":"socket.js","original":{"line":25,"column":12}},{"name":"on","generated":{"line":31,"column":13},"source":"socket.js","original":{"line":25,"column":13}},{"generated":{"line":31,"column":15},"source":"socket.js","original":{"line":25,"column":2}},{"generated":{"line":31,"column":16},"source":"socket.js","original":{"line":25,"column":16}},{"generated":{"line":31,"column":22},"source":"socket.js","original":{"line":25,"column":2}},{"generated":{"line":31,"column":24},"source":"socket.js","original":{"line":25,"column":24}},{"name":"data","generated":{"line":31,"column":34},"source":"socket.js","original":{"line":25,"column":34}},{"generated":{"line":31,"column":38},"source":"socket.js","original":{"line":25,"column":24}},{"generated":{"line":31,"column":40},"source":"socket.js","original":{"line":25,"column":40}},{"name":"process","generated":{"line":32,"column":0},"source":"socket.js","original":{"line":26,"column":4}},{"name":"process","generated":{"line":32,"column":4},"source":"socket.js","original":{"line":26,"column":4}},{"generated":{"line":32,"column":11},"source":"socket.js","original":{"line":26,"column":11}},{"name":"stdout","generated":{"line":32,"column":12},"source":"socket.js","original":{"line":26,"column":12}},{"generated":{"line":32,"column":18},"source":"socket.js","original":{"line":26,"column":4}},{"name":"write","generated":{"line":32,"column":19},"source":"socket.js","original":{"line":26,"column":19}},{"generated":{"line":32,"column":24},"source":"socket.js","original":{"line":26,"column":4}},{"name":"data","generated":{"line":32,"column":25},"source":"socket.js","original":{"line":26,"column":25}},{"generated":{"line":32,"column":29},"source":"socket.js","original":{"line":26,"column":4}},{"name":"console","generated":{"line":33,"column":0},"source":"socket.js","original":{"line":27,"column":4}},{"name":"console","generated":{"line":33,"column":4},"source":"socket.js","original":{"line":27,"column":4}},{"generated":{"line":33,"column":11},"source":"socket.js","original":{"line":27,"column":11}},{"name":"log","generated":{"line":33,"column":12},"source":"socket.js","original":{"line":27,"column":12}},{"generated":{"line":33,"column":15},"source":"socket.js","original":{"line":27,"column":4}},{"generated":{"line":33,"column":16},"source":"socket.js","original":{"line":27,"column":16}},{"generated":{"line":33,"column":22},"source":"socket.js","original":{"line":27,"column":4}},{"name":"data","generated":{"line":33,"column":24},"source":"socket.js","original":{"line":27,"column":23}},{"generated":{"line":33,"column":28},"source":"socket.js","original":{"line":27,"column":4}},{"name":"ws","generated":{"line":34,"column":0},"source":"socket.js","original":{"line":28,"column":4}},{"name":"ws","generated":{"line":34,"column":4},"source":"socket.js","original":{"line":28,"column":4}},{"generated":{"line":34,"column":6},"source":"socket.js","original":{"line":28,"column":6}},{"name":"send","generated":{"line":34,"column":7},"source":"socket.js","original":{"line":28,"column":7}},{"generated":{"line":34,"column":11},"source":"socket.js","original":{"line":28,"column":4}},{"name":"data","generated":{"line":34,"column":12},"source":"socket.js","original":{"line":28,"column":12}},{"generated":{"line":34,"column":16},"source":"socket.js","original":{"line":28,"column":4}},{"generated":{"line":35,"column":0},"source":"socket.js","original":{"line":29,"column":3}},{"generated":{"line":35,"column":3},"source":"socket.js","original":{"line":25,"column":2}},{"generated":{"line":36,"column":0},"source":"socket.js","original":{"line":30,"column":1}},{"generated":{"line":36,"column":1},"source":"socket.js","original":{"line":9,"column":0}}],"sources":{"socket.js":"const pty = require('node-pty');\r\nconst os = require('os');\r\nconst WebSocket = require('ws');\r\nconst shell = os.platform() === 'win32' ? 'powershell.exe' : 'bash';\r\nconst Vorpal = require('./vorpal')\r\n\r\nconst wss = new WebSocket.Server({port: 4001});\r\n\r\nwss.on('connection', (ws) => {\r\n  console.log('socket connection success');\r\n  const ptyProcess = pty.spawn(shell, [], {\r\n    name: 'xterm-color',\r\n    cols: 80,\r\n    rows: 30,\r\n    cwd: process.env.HOME,\r\n    env: process.env\r\n  });\r\n  new Vorpal()\r\n  //接受数据\r\n  ws.on('message', (res) => {\r\n      console.log('接受数据',res)\r\n    ptyProcess.write(res)\r\n  });\r\n  //发送数据\r\n  ptyProcess.on('data', function (data) {\r\n    process.stdout.write(data);\r\n    console.log('发送数据',data)\r\n    ws.send(data)\r\n  });\r\n});"},"lineCount":null}},"error":null,"hash":"90cc4683f131a982c40eb5aa773969a0","cacheData":{"env":{"HOME":"C:\\Users\\montana"}}}